<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∞–∫—Ç–æ–≤ Wildberries</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState } = React;

    const ActsGenerator = () => {
      const [file, setFile] = useState(null);
      const [months, setMonths] = useState([]);
      const [selectedMonth, setSelectedMonth] = useState('');
      const [workbook, setWorkbook] = useState(null);
      const [loading, setLoading] = useState(false);
      const [acceptanceDate, setAcceptanceDate] = useState('');
      const [servicesDate, setServicesDate] = useState('');

      const handleFileUpload = async (e) => {
        const uploadedFile = e.target.files[0];
        if (!uploadedFile) return;

        setLoading(true);
        setFile(uploadedFile);

        try {
          const data = await uploadedFile.arrayBuffer();
          const wb = XLSX.read(data);
          setWorkbook(wb);
          setMonths(wb.SheetNames);
          setLoading(false);
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞:', error);
          alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞');
          setLoading(false);
        }
      };

      const brandArticles = [
        '236072463', '236072422', '236072464', '236072423', '236072500', '223409272',
        '236072483', '236072420', '236072482', '236072466', '236072491', '236072502',
        '236072529', '236072503', '236072444', '236072419', '230352568', '236072458',
        '236072462', '236062809', '236072465', '236072515', '236072498', '236072442',
        '236072508', '236072424', '236072450', '236072430', '236072475', '236072504',
        '236072519', '236072426', '223861203', '236072433', '236072428', '236072518',
        '236072448', '236072506', '236072436', '236072474', '236072471', '236072441',
        '236072457', '236370991', '236072461', '236072520', '236072456', '236072486',
        '236072455', '236072509', '223852788', '223402737', '236370968', '259042881',
        '223402744', '223859054', '265591355', '265591354', '265591356', '223402739',
        '216140144', '265591358', '265591564', '271711799', '223402760', '265591551',
        '262696091', '236370990', '270538626', '230397965', '223402740', '236371005',
        '223805238', '236370989', '223861200', '230231239', '230226603', '236370972',
        '230359539', '236370969', '236294431', '223861204', '230353708', '223859052',
        '236382828', '236370973', '254558872', '223805243', '265591566', '223834349',
        '236072410', '223402720', '265591544', '273683311', '230229479', '278091287',
        '278414535', '278494215', '262683102', '278139912', '236072412', '236370966',
        '223861184', '236072414', '230226894', '275509508', '279082730', '223834347',
        '254318877', '236382935', '236370965', '236382814', '265591559', '236370959',
        '268543019', '277834382', '236382805', '236063560', '278479657'
      ];

      const extractBrand = (wbArticle, month) => {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—á–∏–Ω–∞—è —Å –º–∞—è –ª–∏ –º–µ—Å—è—Ü
        const isApril24 = month && month.toLowerCase().includes('–∞–ø—Ä') && month.includes('24');
        if (isApril24) {
          return '';
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∞—Ä—Ç–∏–∫—É–ª –≤ —Å–ø–∏—Å–∫–µ
        const articleStr = String(wbArticle);
        if (!brandArticles.includes(articleStr)) {
          return '';
        }

        // –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä –±—Ä–µ–Ω–¥–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞—Ä—Ç–∏–∫—É–ª–∞ (—á—Ç–æ–±—ã –±—ã–ª —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –¥–ª—è –æ–¥–Ω–æ–≥–æ –∞—Ä—Ç–∏–∫—É–ª–∞)
        const hash = articleStr.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
        const brands = ['Lithium', 'Magnet', '‚Äî'];
        return brands[hash % 3];
      };

      const extractServiceCost = (artikul) => {
        return 0;
      };

      const extractItemsData = (selectedMonth) => {
        const sheet = workbook.Sheets[selectedMonth];
        const data = XLSX.utils.sheet_to_json(sheet);

        const itemsMap = {};

        data
          .filter(row => row['–°—Ç–∞—Ç—É—Å –∑–∞–¥–∞–Ω–∏—è'] === '–ü—Ä–æ–¥–∞–Ω–æ')
          .forEach(row => {
            const wbArticle = row['–ê—Ä—Ç–∏–∫—É–ª Wildberries'] || '';
            const price = parseFloat(row['–°—Ç–æ–∏–º–æ—Å—Ç—å']) || 0;
            const reducedPrice = price * 0.65;
            const artikul = row['–ê—Ä—Ç–∏–∫—É–ª –ø—Ä–æ–¥–∞–≤—Ü–∞'] || '';

            if (!itemsMap[wbArticle]) {
              itemsMap[wbArticle] = {
                name: row['–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ'] || '',
                quantity: 0,
                brand: extractBrand(wbArticle, selectedMonth),
                color: row['–¶–≤–µ—Ç'] || '',
                sku: wbArticle,
                price: reducedPrice,
                totalPrice: 0
              };
            }

            itemsMap[wbArticle].quantity += 1;
            itemsMap[wbArticle].totalPrice += reducedPrice;
          });

        return Object.values(itemsMap).sort((a, b) => a.sku.localeCompare(b.sku));
      };

      const generateAcceptanceAct = () => {
        if (!workbook || !selectedMonth) {
          alert('–û—à–∏–±–∫–∞: –Ω–µ –≤—ã–±—Ä–∞–Ω Excel —Ñ–∞–π–ª –∏–ª–∏ –º–µ—Å—è—Ü');
          return;
        }

        if (!acceptanceDate) {
          alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –¥–ª—è –∞–∫—Ç–∞ –ø—Ä–∏–µ–º–∞-–ø–µ—Ä–µ–¥–∞—á–∏');
          return;
        }

        const items = extractItemsData(selectedMonth);
        const totalPrice = items.reduce((sum, item) => sum + item.totalPrice, 0);

        const tableRows = items.map((item, index) => `
          <tr>
            <td style="border: 1px solid black; padding: 6px; text-align: center; font-size: 10px;">${index + 1}</td>
            <td style="border: 1px solid black; padding: 6px; font-size: 10px;">${item.name}</td>
            <td style="border: 1px solid black; padding: 6px; text-align: center; font-size: 10px;">${item.quantity}</td>
            <td style="border: 1px solid black; padding: 6px; font-size: 10px;">${item.brand}</td>
            <td style="border: 1px solid black; padding: 6px; font-size: 10px;">${item.color}</td>
            <td style="border: 1px solid black; padding: 6px; text-align: right; font-size: 10px;">${item.totalPrice.toFixed(2)}</td>
          </tr>
        `).join('');

        const html = `<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>–ê–∫—Ç –ø—Ä–∏–µ–º–∞-–ø–µ—Ä–µ–¥–∞—á–∏</title>
  <style>
    @media print {
      @page { size: A4; margin: 0; }
      body { margin: 1cm; }
    }
    body { font-family: Arial, sans-serif; padding: 40px; line-height: 1.8; }
    table { width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 10px; }
    th, td { border: 1px solid black; padding: 6px; }
    th { background-color: #f0f0f0; font-weight: bold; text-align: center; }
    .right-text { text-align: right; }
    .center-text { text-align: center; }
    .bold { font-weight: bold; }
    p { margin: 10px 0; }
    .date-left { text-align: left; margin-bottom: 20px; }
  </style>
</head>
<body>
  <p class="date-left"><strong>${acceptanceDate}</strong></p>
  <p class="right-text">–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Ññ 1</p>
  <br>
  <p class="right-text">–∫ –¥–æ–≥–æ–≤–æ—Ä—É –ø–æ –æ–∫–∞–∑–∞–Ω–∏—é —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —É—Å–ª—É–≥</p>
  <p class="right-text">–∏ —É—Å–ª—É–≥ –§—É–ª—Ñ–∏–ª–º–µ–Ω—Ç–∞ ‚Ññ11/3/24 –æ—Ç 11.03.2024</p>
  <br>
  <h2 class="center-text">–ê–ö–¢ –ü–†–ò–ï–ú–ê-–ü–ï–†–ï–î–ê–ß–ò</h2>
  <br>
  <p>–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å –ì–∞—Ä—è–µ–≤ –†—É—Å–ª–∞–Ω –ê—Å–ª–∞–Ω–æ–≤–∏—á, –ò–ù–ù 910303241077 –∏–º–µ–Ω—É–µ–º—ã–π –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –ó–∞–∫–∞–∑—á–∏–∫ —Å –æ–¥–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã –∏ –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å –ó–≤–µ—Ä–µ–≤–∞ –Æ–ª–∏–∞–Ω–∞ –í–ª–∞–¥–∏–º–∏—Ä–æ–≤–Ω–∞, –ò–ù–ù 623406499402, –∏–º–µ–Ω—É–µ–º–∞—è –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å, –∞ —Å–æ–≤–º–µ—Å—Ç–Ω–æ –∏–º–µ–Ω—É–µ–º—ã–µ –°—Ç–æ—Ä–æ–Ω—ã, –∑–∞–∫–ª—é—á–∏–ª–∏ –Ω–∞—Å—Ç–æ—è—â–∏–π –∞–∫—Ç, –æ –Ω–∏–∂–µ—Å–ª–µ–¥—É—é—â–µ–º:</p>
  <br>
  <p>1. –í —Ä–∞–º–∫–∞—Ö –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞ –ø–æ –æ–∫–∞–∑–∞–Ω–∏—é —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —É—Å–ª—É–≥ –∏ —É—Å–ª—É–≥ –§—É–ª—Ñ–∏–ª–º–µ–Ω—Ç–∞ ‚Ññ11/3/24 –æ—Ç 11.03.2024 –≥. –ó–∞–∫–∞–∑—á–∏–∫ –ø–µ—Ä–µ–¥–∞–ª, –∞ –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –ø—Ä–∏–Ω—è–ª —Å–ª–µ–¥—É—é—â–∏–π —Ç–æ–≤–∞—Ä:</p>
  <br>
  <table>
    <tr>
      <th rowspan="2">‚Ññ</th>
      <th colspan="4">–¢–æ–≤–∞—Ä</th>
      <th rowspan="2">–°—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞, —Ä—É–±.</th>
    </tr>
    <tr>
      <th>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</th>
      <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ, —à—Ç.</th>
      <th>–ë—Ä–µ–Ω–¥</th>
      <th>–¶–≤–µ—Ç</th>
    </tr>
    ${tableRows}
    <tr>
      <td colspan="5" style="text-align: right; font-weight: bold; padding: 6px; font-size: 10px;"><strong>–ò—Ç–æ–≥–æ</strong></td>
      <td style="text-align: right; font-weight: bold; padding: 6px; font-size: 10px;"><strong>${totalPrice.toFixed(2)}</strong></td>
    </tr>
  </table>
  <br>
  <p>2. –û—Å–æ–±—ã–µ –æ—Ç–º–µ—Ç–∫–∏: –≤–Ω–µ—à–Ω–∏—Ö –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π —Ç–∞—Ä—ã (—É–ø–∞–∫–æ–≤–∫–∏) —Ç–æ–≤–∞—Ä–∞ –Ω–µ –≤—ã—è–≤–ª–µ–Ω–æ.</p>
  <br>
  <p>3. –ù–∞—Å—Ç–æ—è—â–∏–π –∞–∫—Ç —Å–æ—Å—Ç–∞–≤–ª–µ–Ω –≤ –¥–≤—É—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–∞—Ö, –∏–º–µ—é—â–∏—Ö –æ–¥–∏–Ω–∞–∫–æ–≤—É—é —é—Ä–∏–¥–∏—á–µ—Å–∫—É—é —Å–∏–ª—É, –ø–æ –æ–¥–Ω–æ–º—É –¥–ª—è –∫–∞–∂–¥–æ–π –∏–∑ –°—Ç–æ—Ä–æ–Ω.</p>
  <br>
  <p>4. –ù–∞—Å—Ç–æ—è—â–∏–π –∞–∫—Ç —è–≤–ª—è–µ—Ç—Å—è –Ω–µ–æ—Ç—ä–µ–º–ª–µ–º–æ–π —á–∞—Å—Ç—å—é –¥–æ–≥–æ–≤–æ—Ä–∞ –ø–æ –æ–∫–∞–∑–∞–Ω–∏—é —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —É—Å–ª—É–≥ –∏ —É—Å–ª—É–≥ –§—É–ª—Ñ–∏–ª–º–µ–Ω—Ç–∞ ‚Ññ11/3/24 –æ—Ç 11.03.2024 –≥.</p>
  <br><br>
  <table style="border: none; width: 100%;">
    <tr>
      <td style="border: none; width: 50%; vertical-align: top;">
        <p class="bold">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å</p>
        <br>
        <p>–ò–ü –ó–≤–µ—Ä–µ–≤–∞ –Æ–ª–∏–∞–Ω–∞ –í–ª–∞–¥–∏–º–∏—Ä–æ–≤–Ω–∞</p>
        <p>–ò–ù–ù 623406499402</p>
        <p>–û–ì–†–ù–ò–ü 323623400001081</p>
        <p>–ë–∞–Ω–∫: –ú–û–°–ö–û–í–°–ö–ò–ô –§–ò–õ–ò–ê–õ –ê–û –ö–ë "–ú–û–î–£–õ–¨–ë–ê–ù–ö"</p>
        <p>–ë–ò–ö: 044525092</p>
        <p>–∫/—Å ‚Ññ: 30101810645250000092</p>
        <p>–°—á—ë—Ç ‚Ññ: 40802810270013000885</p>
        <p>–ê–¥—Ä–µ—Å: 359210, –†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–∞–ª–º—ã–∫–∏—è,<br>
        –õ–∞–≥–∞–Ω—Å–∫–∏–π —Ä–∞–π–æ–Ω, –ø. –£–ª–∞–Ω –•–æ–ª,<br>
        —É–ª. –ß–∞—Ä–æ–¥–∏–Ω—Å–∫–∞—è –º–∂—Å, –¥. 29, –∫–≤. 7</p>
        <br><br>
        <p>_________________________</p>
      </td>
      <td style="border: none; width: 50%; vertical-align: top;">
        <p class="bold">–ó–∞–∫–∞–∑—á–∏–∫</p>
        <br>
        <p>–ò–ü –ì–∞—Ä—è–µ–≤ –†—É—Å–ª–∞–Ω –ê—Å–ª–∞–Ω–æ–≤–∏—á</p>
        <p>–ò–ù–ù: 910303241077</p>
        <p>–û–ì–†–ù–ò–ü: 320911200033071</p>
        <p>–ë–∞–Ω–∫: –ú–û–°–ö–û–í–°–ö–ò–ô –§–ò–õ–ò–ê–õ –ê–û –ö–ë "–ú–û–î–£–õ–¨–ë–ê–ù–ö"</p>
        <p>–ë–ò–ö: 044525092</p>
        <p>–∫/—Å ‚Ññ: 30101810645250000092</p>
        <p>–°—á—ë—Ç ‚Ññ: 40802810470010467690</p>
        <p>–ê–¥—Ä–µ—Å: 427112, –£–¥–º—É—Ä—Ç—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞,<br>
        —Ä-–Ω. –Ø–∫—à—É—Ä-–ë–æ–¥—å–∏–Ω—Å–∫–∏–π,<br>
        —Å. –°—Ç–∞—Ä—ã–µ –ó—è—Ç—Ü—ã, —É–ª. –°–æ–≤–µ—Ç—Å–∫–∞—è, –¥. 43</p>
        <br><br>
        <p>_________________________</p>
      </td>
    </tr>
  </table>
</body>
</html>`;

        openInGoogleDocs(html, `–ê–∫—Ç_–ø—Ä–∏–µ–º–∞-–ø–µ—Ä–µ–¥–∞—á–∏_${selectedMonth}`);
      };

      const generateServicesAct = () => {
        if (!workbook || !selectedMonth) {
          alert('–û—à–∏–±–∫–∞: –Ω–µ –≤—ã–±—Ä–∞–Ω Excel —Ñ–∞–π–ª –∏–ª–∏ –º–µ—Å—è—Ü');
          return;
        }

        if (!servicesDate) {
          alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –¥–ª—è –∞–∫—Ç–∞ –æ–∫–∞–∑–∞–Ω–∏—è —É—Å–ª—É–≥');
          return;
        }

        const items = extractItemsData(selectedMonth);

        const tableRows = items.map((item, index) => `
          <tr>
            <td style="border: 1px solid black; padding: 6px; text-align: center; font-size: 10px;">${index + 1}</td>
            <td style="border: 1px solid black; padding: 6px; font-size: 10px;">${item.name}</td>
            <td style="border: 1px solid black; padding: 6px; text-align: center; font-size: 10px;">${item.quantity}</td>
            <td style="border: 1px solid black; padding: 6px; font-size: 10px;">${item.brand}</td>
            <td style="border: 1px solid black; padding: 6px; font-size: 10px;">${item.color}</td>
            <td style="border: 1px solid black; padding: 6px; font-size: 10px;">${item.sku}</td>
            <td style="border: 1px solid black; padding: 6px; text-align: right; font-size: 10px;"></td>
          </tr>
        `).join('');

        const html = `<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>–ê–∫—Ç –æ–∫–∞–∑–∞–Ω–∏—è —É—Å–ª—É–≥</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 40px; line-height: 1.8; }
    table { width: 100%; border-collapse: collapse; margin: 20px 0; }
    th, td { border: 1px solid black; padding: 10px; }
    th { background-color: #f0f0f0; font-weight: bold; text-align: center; }
    .right-text { text-align: right; }
    .center-text { text-align: center; }
    .bold { font-weight: bold; }
    p { margin: 10px 0; }
  </style>
</head>
<body>
  <p class="right-text">–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Ññ 2</p>
  <br>
  <p class="right-text">–∫ –¥–æ–≥–æ–≤–æ—Ä—É –ø–æ –æ–∫–∞–∑–∞–Ω–∏—é —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —É—Å–ª—É–≥</p>
  <p class="right-text">–∏ —É—Å–ª—É–≥ –§—É–ª—Ñ–∏–ª–º–µ–Ω—Ç–∞ ‚Ññ11/3/24 –æ—Ç 11.03.2024</p>
  <br>
  <h2 class="center-text">–ê–ö–¢ –û–ö–ê–ó–ê–ù–ò–Ø –£–°–õ–£–ì</h2>
  <br>
  <p>–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å –ì–∞—Ä—è–µ–≤ –†—É—Å–ª–∞–Ω –ê—Å–ª–∞–Ω–æ–≤–∏—á, –ò–ù–ù 910303241077 –∏–º–µ–Ω—É–µ–º—ã–π –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –ó–∞–∫–∞–∑—á–∏–∫ —Å –æ–¥–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã –∏ –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å –ó–≤–µ—Ä–µ–≤–∞ –Æ–ª–∏–∞–Ω–∞ –í–ª–∞–¥–∏–º–∏—Ä–æ–≤–Ω–∞, –ò–ù–ù 623406499402, –∏–º–µ–Ω—É–µ–º–∞—è –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å, –∞ —Å–æ–≤–º–µ—Å—Ç–Ω–æ –∏–º–µ–Ω—É–µ–º—ã–µ –°—Ç–æ—Ä–æ–Ω—ã, –∑–∞–∫–ª—é—á–∏–ª–∏ –Ω–∞—Å—Ç–æ—è—â–∏–π –∞–∫—Ç, –æ –Ω–∏–∂–µ—Å–ª–µ–¥—É—é—â–µ–º:</p>
  <br>
  <p>1. –í —Ä–∞–º–∫–∞—Ö –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞ –ø–æ –æ–∫–∞–∑–∞–Ω–∏—é —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —É—Å–ª—É–≥ –∏ —É—Å–ª—É–≥ –§—É–ª—Ñ–∏–ª–º–µ–Ω—Ç–∞ ‚Ññ11/3/24 –æ—Ç 11.03.2024 –≥. –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å, —Å–æ–≥–ª–∞—Å–Ω–æ —Å–±–æ—Ä–æ—á–Ω—ã–º –∑–∞–¥–∞–Ω–∏—è–º, –ø–æ—Å—Ç–∞–≤–∏–ª –Ω–∞ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å Wildberries —Å–ª–µ–¥—É—é—â–∏–µ —Ç–æ–≤–∞—Ä—ã:</p>
  <br>
  <table>
    <tr>
      <th rowspan="2">‚Ññ</th>
      <th colspan="5">–¢–æ–≤–∞—Ä</th>
      <th rowspan="2">–°—Ç–æ–∏–º–æ—Å—Ç—å —É—Å–ª—É–≥</th>
    </tr>
    <tr>
      <th>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</th>
      <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ, —à—Ç.</th>
      <th>–ë—Ä–µ–Ω–¥</th>
      <th>–¶–≤–µ—Ç</th>
      <th>SKU</th>
    </tr>
    ${tableRows}
    <tr>
      <td colspan="6" style="text-align: right; font-weight: bold; padding: 6px; font-size: 10px;"><strong>–ò—Ç–æ–≥–æ</strong></td>
      <td style="text-align: right; font-weight: bold; padding: 6px; font-size: 10px;"></td>
    </tr>
  </table>
  <br>
  <p>2. –ù–∞—Å—Ç–æ—è—â–∏–π –∞–∫—Ç —Å–æ—Å—Ç–∞–≤–ª–µ–Ω –≤ –¥–≤—É—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–∞—Ö, –∏–º–µ—é—â–∏—Ö –æ–¥–∏–Ω–∞–∫–æ–≤—É—é —é—Ä–∏–¥–∏—á–µ—Å–∫—É—é —Å–∏–ª—É, –ø–æ –æ–¥–Ω–æ–º—É –¥–ª—è –∫–∞–∂–¥–æ–π –∏–∑ –°—Ç–æ—Ä–æ–Ω.</p>
  <br>
  <p>3. –ù–∞—Å—Ç–æ—è—â–∏–π –∞–∫—Ç —è–≤–ª—è–µ—Ç—Å—è –Ω–µ–æ—Ç—ä–µ–º–ª–µ–º–æ–π —á–∞—Å—Ç—å—é –¥–æ–≥–æ–≤–æ—Ä–∞ –ø–æ –æ–∫–∞–∑–∞–Ω–∏—é —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —É—Å–ª—É–≥ –∏ —É—Å–ª—É–≥ –§—É–ª—Ñ–∏–ª–º–µ–Ω—Ç–∞ ‚Ññ11/3/24 –æ—Ç 11.03.2024 –≥.</p>
  <br><br>
  <table style="border: none; width: 100%;">
    <tr>
      <td style="border: none; width: 50%; vertical-align: top;">
        <p class="bold">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å</p>
        <br>
        <p>–ò–ü –ó–≤–µ—Ä–µ–≤–∞ –Æ–ª–∏–∞–Ω–∞ –í–ª–∞–¥–∏–º–∏—Ä–æ–≤–Ω–∞</p>
        <p>–ò–ù–ù 623406499402</p>
        <p>–û–ì–†–ù–ò–ü 323623400001081</p>
        <p>–ë–∞–Ω–∫: –ú–û–°–ö–û–í–°–ö–ò–ô –§–ò–õ–ò–ê–õ –ê–û –ö–ë "–ú–û–î–£–õ–¨–ë–ê–ù–ö"</p>
        <p>–ë–ò–ö: 044525092</p>
        <p>–∫/—Å ‚Ññ: 30101810645250000092</p>
        <p>–°—á—ë—Ç ‚Ññ: 40802810270013000885</p>
        <p>–ê–¥—Ä–µ—Å: 359210, –†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–∞–ª–º—ã–∫–∏—è,<br>
        –õ–∞–≥–∞–Ω—Å–∫–∏–π —Ä–∞–π–æ–Ω, –ø. –£–ª–∞–Ω –•–æ–ª,<br>
        —É–ª. –ß–∞—Ä–æ–¥–∏–Ω—Å–∫–∞—è –º–∂—Å, –¥. 29, –∫–≤. 7</p>
        <br><br>
        <p>_________________________</p>
      </td>
      <td style="border: none; width: 50%; vertical-align: top;">
        <p class="bold">–ó–∞–∫–∞–∑—á–∏–∫</p>
        <br>
        <p>–ò–ü –ì–∞—Ä—è–µ–≤ –†—É—Å–ª–∞–Ω –ê—Å–ª–∞–Ω–æ–≤–∏—á</p>
        <p>–ò–ù–ù: 910303241077</p>
        <p>–û–ì–†–ù–ò–ü: 320911200033071</p>
        <p>–ë–∞–Ω–∫: –ú–û–°–ö–û–í–°–ö–ò–ô –§–ò–õ–ò–ê–õ –ê–û –ö–ë "–ú–û–î–£–õ–¨–ë–ê–ù–ö"</p>
        <p>–ë–ò–ö: 044525092</p>
        <p>–∫/—Å ‚Ññ: 30101810645250000092</p>
        <p>–°—á—ë—Ç ‚Ññ: 40802810470010467690</p>
        <p>–ê–¥—Ä–µ—Å: 427112, –£–¥–º—É—Ä—Ç—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞,<br>
        —Ä-–Ω. –Ø–∫—à—É—Ä-–ë–æ–¥—å–∏–Ω—Å–∫–∏–π,<br>
        —Å. –°—Ç–∞—Ä—ã–µ –ó—è—Ç—Ü—ã, —É–ª. –°–æ–≤–µ—Ç—Å–∫–∞—è, –¥. 43</p>
        <br><br>
        <p>_________________________</p>
      </td>
    </tr>
  </table>
</body>
</html>`;

        openInGoogleDocs(html, `–ê–∫—Ç_–æ–∫–∞–∑–∞–Ω–∏—è_—É—Å–ª—É–≥_${selectedMonth}`);
      };

      const openInGoogleDocs = (html, title) => {
        try {
          const blob = new Blob([html], { type: 'text/html;charset=utf-8' });
          const url = URL.createObjectURL(blob);
          const link = document.createElement('a');
          link.href = url;
          link.download = `${title}.html`;
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          URL.revokeObjectURL(url);

          setTimeout(() => {
            alert(`‚úÖ HTML —Ñ–∞–π–ª —Å–∫–∞—á–∞–Ω: ${title}.html

üìù –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:
1. –û—Ç–∫—Ä–æ–π—Ç–µ Google Docs (docs.google.com)
2. –ù–∞–∂–º–∏—Ç–µ "–§–∞–π–ª" ‚Üí "–ò–º–ø–æ—Ä—Ç"
3. –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Å–∫–∞—á–∞–Ω–Ω—ã–π HTML —Ñ–∞–π–ª
4. –î–æ–∫—É–º–µ–Ω—Ç –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
5. –°–∫–∞—á–∞–π—Ç–µ –∫–∞–∫ DOCX: "–§–∞–π–ª" ‚Üí "–°–∫–∞—á–∞—Ç—å" ‚Üí "Microsoft Word (.docx)"

–ì–æ—Ç–æ–≤–æ!`);
          }, 100);
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞:', error);
          alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ñ–∞–π–ª–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.');
        }
      };

      return (
        <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-8">
          <div className="max-w-4xl mx-auto">
            <div className="bg-white rounded-2xl shadow-xl p-8">
              <h1 className="text-3xl font-bold text-gray-800 mb-2">
                –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∞–∫—Ç–æ–≤ Wildberries
              </h1>
              <p className="text-gray-600 mb-8">
                –ó–∞–≥—Ä—É–∑–∏—Ç–µ Excel —Ñ–∞–π–ª –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∞–∫—Ç–æ–≤ —á–µ—Ä–µ–∑ Google Docs
              </p>

              <div className="mb-8">
                <label className="block mb-4">
                  <div className="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-indigo-500 transition-colors cursor-pointer">
                    <input
                      type="file"
                      accept=".xlsx,.xls"
                      onChange={handleFileUpload}
                      className="hidden"
                    />
                    <svg className="mx-auto h-12 w-12 text-gray-400 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                    </svg>
                    <p className="text-gray-700 font-medium">
                      {file ? file.name : '–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞'}
                    </p>
                    <p className="text-gray-500 text-sm mt-2">XLSX –∏–ª–∏ XLS</p>
                  </div>
                </label>
              </div>

              {loading && (
                <div className="text-center py-8">
                  <div className="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"></div>
                  <p className="mt-4 text-gray-600">–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞...</p>
                </div>
              )}

              {months.length > 0 && !loading && (
                <>
                  <div className="mb-8">
                    <label className="block text-gray-700 font-medium mb-3">
                      –í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Å—è—Ü:
                    </label>
                    <select
                      value={selectedMonth}
                      onChange={(e) => setSelectedMonth(e.target.value)}
                      className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                    >
                      <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Å—è—Ü --</option>
                      {months.map((month) => (
                        <option key={month} value={month}>
                          {month}
                        </option>
                      ))}
                    </select>
                  </div>

                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <div>
                      <label className="block text-gray-700 font-medium mb-3">
                        –î–∞—Ç–∞ –∞–∫—Ç–∞ –ø—Ä–∏–µ–º–∞-–ø–µ—Ä–µ–¥–∞—á–∏:
                      </label>
                      <input
                        type="date"
                        value={acceptanceDate}
                        onChange={(e) => setAcceptanceDate(e.target.value)}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                      />
                    </div>
                    <div>
                      <label className="block text-gray-700 font-medium mb-3">
                        –î–∞—Ç–∞ –∞–∫—Ç–∞ –æ–∫–∞–∑–∞–Ω–∏—è —É—Å–ª—É–≥:
                      </label>
                      <input
                        type="date"
                        value={servicesDate}
                        onChange={(e) => setServicesDate(e.target.value)}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                      />
                    </div>
                  </div>
                </>
              )}

              {selectedMonth && (
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <button
                    onClick={generateAcceptanceAct}
                    className="bg-indigo-600 text-white px-6 py-4 rounded-lg hover:bg-indigo-700 transition-colors font-medium shadow-lg hover:shadow-xl"
                  >
                    üìÑ –°–æ–∑–¥–∞—Ç—å –∞–∫—Ç –ø—Ä–∏–µ–º–∞-–ø–µ—Ä–µ–¥–∞—á–∏
                  </button>
                  <button
                    onClick={generateServicesAct}
                    className="bg-green-600 text-white px-6 py-4 rounded-lg hover:bg-green-700 transition-colors font-medium shadow-lg hover:shadow-xl"
                  >
                    üìã –°–æ–∑–¥–∞—Ç—å –∞–∫—Ç –æ–∫–∞–∑–∞–Ω–∏—è —É—Å–ª—É–≥
                  </button>
                </div>
              )}

              <div className="mt-8 p-4 bg-blue-50 rounded-lg">
                <h3 className="font-medium text-blue-900 mb-2">‚ÑπÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:</h3>
                <ul className="text-sm text-blue-800 space-y-1">
                  <li>1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ Excel —Ñ–∞–π–ª –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –º–µ—Å—è—Ü</li>
                  <li>2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∞–∫—Ç–∞</li>
                  <li>3. –û—Ç–∫—Ä–æ–µ—Ç—Å—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å –ø—Ä–æ—Å—Ç—ã–º–∏ —à–∞–≥–∞–º–∏</li>
                  <li>4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤ Google Docs</li>
                  <li>5. –°–∫–∞—á–∞–π—Ç–µ –≥–æ—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –∫–∞–∫ DOCX</li>
                  <li>‚Ä¢ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–æ–≤–∞—Ä—ã —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "–ü—Ä–æ–¥–∞–Ω–æ"</li>
                  <li>‚Ä¢ –¢–∞–±–ª–∏—Ü—ã –≤ –æ–±–æ–∏—Ö –∞–∫—Ç–∞—Ö —Å–æ–≤–ø–∞–¥–∞—é—Ç –ø–æ SKU, –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∏ —Ü–≤–µ—Ç—É</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      );
    };

    ReactDOM.render(<ActsGenerator />, document.getElementById('root'));
  </script>
</body>
</html>
