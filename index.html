<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∞–∫—Ç–æ–≤ Wildberries</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/html-docx-js@0.3.1/dist/html-docx.min.js"></script>
  <style>
    @media print {
      @page {
        margin: 0;
      }
      body::before,
      body::after {
        display: none !important;
      }
      header, footer {
        display: none !important;
      }
    }
    @keyframes spin-slow {
      from {
        transform: rotate(0deg);
      }
      to {
        transform: rotate(360deg);
      }
    }
    .animate-spin-slow {
      animation: spin-slow 2s linear infinite;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState } = React;

    const ActsGenerator = () => {
      const [file, setFile] = useState(null);
      const [brandsFile, setBrandsFile] = useState(null);
      const [brandsMap, setBrandsMap] = useState({});
      const [months, setMonths] = useState([]);
      const [selectedMonth, setSelectedMonth] = useState('');
      const [workbook, setWorkbook] = useState(null);
      const [loading, setLoading] = useState(false);
      const [acceptanceDate, setAcceptanceDate] = useState('');
      const [servicesDate, setServicesDate] = useState('');

      const handleBrandsFileUpload = async (e) => {
        const uploadedFile = e.target.files[0];
        if (!uploadedFile) return;

        setBrandsFile(uploadedFile);

        try {
          const data = await uploadedFile.arrayBuffer();
          const wb = XLSX.read(data);
          const sheet = wb.Sheets[wb.SheetNames[0]];

          const rawData = XLSX.utils.sheet_to_json(sheet, { header: 1 });

          let headerRowIndex = 0;
          for (let i = 0; i < Math.min(10, rawData.length); i++) {
            const row = rawData[i];
            if (row && row.some(cell => String(cell).includes('–ë—Ä–µ–Ω–¥')) &&
                row.some(cell => String(cell).includes('–ê—Ä—Ç–∏–∫—É–ª WB'))) {
              headerRowIndex = i;
              break;
            }
          }

          const headers = rawData[headerRowIndex];
          const brandColIndex = headers.findIndex(h => String(h).includes('–ë—Ä–µ–Ω–¥'));
          const articleColIndex = headers.findIndex(h => String(h).includes('–ê—Ä—Ç–∏–∫—É–ª WB'));
          const sellerArticleColIndex = headers.findIndex(h => String(h).includes('–ê—Ä—Ç–∏–∫—É–ª –ø—Ä–æ–¥–∞–≤—Ü–∞'));

          console.log('–°—Ç—Ä–æ–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤:', headerRowIndex);
          console.log('–ò–Ω–¥–µ–∫—Å –∫–æ–ª–æ–Ω–∫–∏ –ë—Ä–µ–Ω–¥:', brandColIndex);
          console.log('–ò–Ω–¥–µ–∫—Å –∫–æ–ª–æ–Ω–∫–∏ –ê—Ä—Ç–∏–∫—É–ª WB:', articleColIndex);
          console.log('–ò–Ω–¥–µ–∫—Å –∫–æ–ª–æ–Ω–∫–∏ –ê—Ä—Ç–∏–∫—É–ª –ø—Ä–æ–¥–∞–≤—Ü–∞:', sellerArticleColIndex);

          const map = {};
          for (let i = headerRowIndex + 1; i < rawData.length; i++) {
            const row = rawData[i];
            if (!row) continue;

            const wbArticle = row[articleColIndex];
            const brand = row[brandColIndex];
            const sellerArticle = sellerArticleColIndex >= 0 ? row[sellerArticleColIndex] : '';

            if (wbArticle) {
              const articleStr = String(wbArticle).trim();
              if (!map[articleStr]) {
                map[articleStr] = {
                  brand: brand ? String(brand).trim() : '',
                  sellerArticle: sellerArticle ? String(sellerArticle).trim() : ''
                };
              }
            }
          }

          setBrandsMap(map);
          console.log('–ó–∞–≥—Ä—É–∂–µ–Ω–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∞—Ä—Ç–∏–∫—É–ª–æ–≤ —Å –±—Ä–µ–Ω–¥–∞–º–∏:', Object.keys(map).length);
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –±—Ä–µ–Ω–¥–æ–≤:', error);
        }
      };

      const handleFileUpload = async (e) => {
        const uploadedFile = e.target.files[0];
        if (!uploadedFile) return;

        setLoading(true);
        setFile(uploadedFile);

        try {
          const data = await uploadedFile.arrayBuffer();
          const wb = XLSX.read(data);
          setWorkbook(wb);
          setMonths(wb.SheetNames);
          setLoading(false);
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞:', error);
          alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞');
          setLoading(false);
        }
      };

      const brandArticles = [
        '236072463', '236072422', '236072464', '236072423', '236072500', '223409272',
        '236072483', '236072420', '236072482', '236072466', '236072491', '236072502',
        '236072529', '236072503', '236072444', '236072419', '230352568', '236072458',
        '236072462', '236062809', '236072465', '236072515', '236072498', '236072442',
        '236072508', '236072424', '236072450', '236072430', '236072475', '236072504',
        '236072519', '236072426', '223861203', '236072433', '236072428', '236072518',
        '236072448', '236072506', '236072436', '236072474', '236072471', '236072441',
        '236072457', '236370991', '236072461', '236072520', '236072456', '236072486',
        '236072455', '236072509', '223852788', '223402737', '236370968', '259042881',
        '223402744', '223859054', '265591355', '265591354', '265591356', '223402739',
        '216140144', '265591358', '265591564', '271711799', '223402760', '265591551',
        '262696091', '236370990', '270538626', '230397965', '223402740', '236371005',
        '223805238', '236370989', '223861200', '230231239', '230226603', '236370972',
        '230359539', '236370969', '236294431', '223861204', '230353708', '223859052',
        '236382828', '236370973', '254558872', '223805243', '265591566', '223834349',
        '236072410', '223402720', '265591544', '273683311', '230229479', '278091287',
        '278414535', '278494215', '262683102', '278139912', '236072412', '236370966',
        '223861184', '236072414', '230226894', '275509508', '279082730', '223834347',
        '254318877', '236382935', '236370965', '236382814', '265591559', '236370959',
        '268543019', '277834382', '236382805', '236063560', '278479657'
      ];

      const extractBrand = (wbArticle, month) => {
        const articleStr = String(wbArticle);

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—á–∏–Ω–∞—è —Å –º–∞—è –ª–∏ –º–µ—Å—è—Ü
        const isApril24 = month && month.toLowerCase().includes('–∞–ø—Ä') && month.includes('24');
        if (isApril24) {
          return '';
        }

        // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏–∑ 119 –∞—Ä—Ç–∏–∫—É–ª–æ–≤
        if (brandArticles.includes(articleStr)) {
          const hash = articleStr.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
          const brands = ['Lithium', 'Magnet', '‚Äî'];
          return brands[hash % 3];
        }

        // –ó–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –±—Ä–µ–Ω–¥–æ–≤
        if (brandsMap[articleStr] && brandsMap[articleStr].brand) {
          return brandsMap[articleStr].brand;
        }

        return '';
      };

      const getSellerArticleFromBrandsMap = (wbArticle) => {
        const articleStr = String(wbArticle);
        if (brandsMap[articleStr] && brandsMap[articleStr].sellerArticle) {
          return brandsMap[articleStr].sellerArticle;
        }
        return '';
      };

      const extractServiceCost = (artikul) => {
        return 0;
      };

      const extractItemsData = (selectedMonth) => {
        const sheet = workbook.Sheets[selectedMonth];
        const data = XLSX.utils.sheet_to_json(sheet);

        console.log('–í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫ –≤ Excel:', data.length);
        console.log('–†–∞–∑–º–µ—Ä brandsMap:', Object.keys(brandsMap).length);

        const itemsMap = {};

        const soldItems = data.filter(row => row['–°—Ç–∞—Ç—É—Å –∑–∞–¥–∞–Ω–∏—è'] === '–ü—Ä–æ–¥–∞–Ω–æ');
        console.log('–°—Ç—Ä–æ–∫ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º –ü—Ä–æ–¥–∞–Ω–æ:', soldItems.length);

        soldItems.forEach(row => {
          const wbArticle = row['–ê—Ä—Ç–∏–∫—É–ª Wildberries'] || '';
          const price = parseFloat(row['–°—Ç–æ–∏–º–æ—Å—Ç—å']) || 0;
          const reducedPrice = price * 0.65;
          const sellerArticleFromExcel = row['–ê—Ä—Ç–∏–∫—É–ª –ø—Ä–æ–¥–∞–≤—Ü–∞'] || '';

          if (!itemsMap[wbArticle]) {
            const sellerArticleFromBrands = getSellerArticleFromBrandsMap(wbArticle);
            const brand = extractBrand(wbArticle, selectedMonth);

            if (Object.keys(itemsMap).length < 3) {
              console.log('–ê—Ä—Ç–∏–∫—É–ª WB:', wbArticle);
              console.log('–ë—Ä–µ–Ω–¥ –∏–∑ brandsMap:', brandsMap[String(wbArticle)]);
              console.log('–ò—Ç–æ–≥–æ–≤—ã–π –±—Ä–µ–Ω–¥:', brand);
              console.log('–ê—Ä—Ç–∏–∫—É–ª –ø—Ä–æ–¥–∞–≤—Ü–∞ –∏–∑ Excel:', sellerArticleFromExcel);
              console.log('–ê—Ä—Ç–∏–∫—É–ª –ø—Ä–æ–¥–∞–≤—Ü–∞ –∏–∑ brandsMap:', sellerArticleFromBrands);
            }

            itemsMap[wbArticle] = {
              name: row['–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ'] || '',
              quantity: 0,
              brand: brand,
              color: row['–¶–≤–µ—Ç'] || '',
              sku: wbArticle,
              sellerArticle: sellerArticleFromBrands || sellerArticleFromExcel,
              price: reducedPrice,
              totalPrice: 0
            };
          }

          itemsMap[wbArticle].quantity += 1;
          itemsMap[wbArticle].totalPrice += reducedPrice;
        });

        const items = Object.values(itemsMap).sort((a, b) => a.sku.localeCompare(b.sku));
        console.log('–ò—Ç–æ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤:', items.length);

        return items;
      };

      const validateSellerArticles = (items) => {
        const inconsistencies = [];

        items.forEach(item => {
          if (item.sellerArticle) {
            const duplicates = items.filter(i =>
              i.sellerArticle === item.sellerArticle && i.sku !== item.sku
            );

            if (duplicates.length > 0) {
              const skus = [item.sku, ...duplicates.map(d => d.sku)].join(', ');
              if (!inconsistencies.some(inc => inc.sellerArticle === item.sellerArticle)) {
                inconsistencies.push({
                  sellerArticle: item.sellerArticle,
                  skus: skus
                });
              }
            }
          }
        });

        if (inconsistencies.length > 0) {
          const message = '–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –≤ –∞—Ä—Ç–∏–∫—É–ª–∞—Ö –ø—Ä–æ–¥–∞–≤—Ü–∞:\n\n' +
            inconsistencies.map(inc =>
              `–ê—Ä—Ç–∏–∫—É–ª –ø—Ä–æ–¥–∞–≤—Ü–∞ "${inc.sellerArticle}" –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞—Ä—Ç–∏–∫—É–ª–æ–≤ WB: ${inc.skus}`
            ).join('\n\n') +
            '\n\n–í–æ–∑–º–æ–∂–Ω–æ, —ç—Ç–æ –æ—à–∏–±–∫–∞ –≤ –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª —Å –±—Ä–µ–Ω–¥–∞–º–∏ –∏–ª–∏ Excel —Ñ–∞–π–ª.';

          if (!confirm(message + '\n\n–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∞–∫—Ç–æ–≤?')) {
            return false;
          }
        }

        return true;
      };

      const generateAcceptanceAct = () => {
        if (!workbook || !selectedMonth) {
          alert('–û—à–∏–±–∫–∞: –Ω–µ –≤—ã–±—Ä–∞–Ω Excel —Ñ–∞–π–ª –∏–ª–∏ –º–µ—Å—è—Ü');
          return;
        }

        if (!acceptanceDate) {
          alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –¥–ª—è –∞–∫—Ç–∞ –ø—Ä–∏–µ–º–∞-–ø–µ—Ä–µ–¥–∞—á–∏');
          return;
        }

        const items = extractItemsData(selectedMonth);

        if (!validateSellerArticles(items)) {
          return;
        }

        const totalPrice = items.reduce((sum, item) => sum + item.totalPrice, 0);

        const tableRows = items.map((item, index) => `
          <tr>
            <td style="border: 1px solid black; padding: 0px 2px; text-align: center; font-size: 7px;">${index + 1}</td>
            <td style="border: 1px solid black; padding: 0px 2px; font-size: 7px;">${item.name}</td>
            <td style="border: 1px solid black; padding: 0px 2px; text-align: center; font-size: 7px;">${item.quantity}</td>
            <td style="border: 1px solid black; padding: 0px 2px; font-size: 7px;">${item.brand}</td>
            <td style="border: 1px solid black; padding: 0px 2px; font-size: 7px;">${item.sellerArticle || ''}</td>
            <td style="border: 1px solid black; padding: 0px 2px; font-size: 7px;">${item.color}</td>
            <td style="border: 1px solid black; padding: 0px 2px; text-align: right; font-size: 7px;">${item.totalPrice.toFixed(2)}</td>
          </tr>
        `).join('');

        const html = `<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>–ê–∫—Ç –ø—Ä–∏–µ–º–∞-–ø–µ—Ä–µ–¥–∞—á–∏</title>
  <style>
    @media print {
      @page { size: A4; margin: 0; }
      body { margin: 1cm; }
    }
    body { font-family: Arial, sans-serif; padding: 40px; line-height: 1.8; }
    table { width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 7px; line-height: 0.9; }
    th, td { border: 1px solid black; padding: 0px 3px; height: 12px; }
    th { background-color: #f0f0f0; font-weight: bold; text-align: center; font-size: 7px; height: 12px; }
    .right-text { text-align: right; }
    .center-text { text-align: center; }
    .bold { font-weight: bold; }
    p { margin: 10px 0; }
    .date-left { text-align: left; margin-bottom: 20px; }
    td:nth-child(1) { width: 3%; }
    td:nth-child(2) { width: 35%; }
    td:nth-child(3) { width: 7%; }
    td:nth-child(4) { width: 12%; }
    td:nth-child(5) { width: 15%; }
    td:nth-child(6) { width: 15%; }
    td:nth-child(7) { width: 13%; }
  </style>
</head>
<body>
  <p class="date-left"><strong>${acceptanceDate}</strong></p>
  <p class="right-text">–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Ññ 1</p>
  <br>
  <p class="right-text">–∫ –¥–æ–≥–æ–≤–æ—Ä—É –ø–æ –æ–∫–∞–∑–∞–Ω–∏—é —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —É—Å–ª—É–≥</p>
  <p class="right-text">–∏ —É—Å–ª—É–≥ –§—É–ª—Ñ–∏–ª–º–µ–Ω—Ç–∞ ‚Ññ11/3/24 –æ—Ç 11.03.2024</p>
  <br>
  <h2 class="center-text">–ê–ö–¢ –ü–†–ò–ï–ú–ê-–ü–ï–†–ï–î–ê–ß–ò</h2>
  <br>
  <p>–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å –ì–∞—Ä—è–µ–≤ –†—É—Å–ª–∞–Ω –ê—Å–ª–∞–Ω–æ–≤–∏—á, –ò–ù–ù 910303241077 –∏–º–µ–Ω—É–µ–º—ã–π –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –ó–∞–∫–∞–∑—á–∏–∫ —Å –æ–¥–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã –∏ –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å –ó–≤–µ—Ä–µ–≤–∞ –Æ–ª–∏–∞–Ω–∞ –í–ª–∞–¥–∏–º–∏—Ä–æ–≤–Ω–∞, –ò–ù–ù 623406499402, –∏–º–µ–Ω—É–µ–º–∞—è –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å, –∞ —Å–æ–≤–º–µ—Å—Ç–Ω–æ –∏–º–µ–Ω—É–µ–º—ã–µ –°—Ç–æ—Ä–æ–Ω—ã, –∑–∞–∫–ª—é—á–∏–ª–∏ –Ω–∞—Å—Ç–æ—è—â–∏–π –∞–∫—Ç, –æ –Ω–∏–∂–µ—Å–ª–µ–¥—É—é—â–µ–º:</p>
  <br>
  <p>1. –í —Ä–∞–º–∫–∞—Ö –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞ –ø–æ –æ–∫–∞–∑–∞–Ω–∏—é —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —É—Å–ª—É–≥ –∏ —É—Å–ª—É–≥ –§—É–ª—Ñ–∏–ª–º–µ–Ω—Ç–∞ ‚Ññ11/3/24 –æ—Ç 11.03.2024 –≥. –ó–∞–∫–∞–∑—á–∏–∫ –ø–µ—Ä–µ–¥–∞–ª, –∞ –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –ø—Ä–∏–Ω—è–ª —Å–ª–µ–¥—É—é—â–∏–π —Ç–æ–≤–∞—Ä:</p>
  <br>
  <table>
    <tr>
      <th rowspan="2">‚Ññ</th>
      <th colspan="5">–¢–æ–≤–∞—Ä</th>
      <th rowspan="2">–°—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞, —Ä—É–±.</th>
    </tr>
    <tr>
      <th>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</th>
      <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ, —à—Ç.</th>
      <th>–ë—Ä–µ–Ω–¥</th>
      <th>–ê—Ä—Ç–∏–∫—É–ª –ø—Ä–æ–¥–∞–≤—Ü–∞</th>
      <th>–¶–≤–µ—Ç</th>
    </tr>
    ${tableRows}
    <tr>
      <td colspan="6" style="text-align: right; font-weight: bold; padding: 0px 2px; font-size: 7px;"><strong>–ò—Ç–æ–≥–æ</strong></td>
      <td style="text-align: right; font-weight: bold; padding: 0px 2px; font-size: 7px;"><strong>${totalPrice.toFixed(2)}</strong></td>
    </tr>
  </table>
  <br>
  <p>2. –û—Å–æ–±—ã–µ –æ—Ç–º–µ—Ç–∫–∏: –≤–Ω–µ—à–Ω–∏—Ö –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π —Ç–∞—Ä—ã (—É–ø–∞–∫–æ–≤–∫–∏) —Ç–æ–≤–∞—Ä–∞ –Ω–µ –≤—ã—è–≤–ª–µ–Ω–æ.</p>
  <br>
  <p>3. –ù–∞—Å—Ç–æ—è—â–∏–π –∞–∫—Ç —Å–æ—Å—Ç–∞–≤–ª–µ–Ω –≤ –¥–≤—É—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–∞—Ö, –∏–º–µ—é—â–∏—Ö –æ–¥–∏–Ω–∞–∫–æ–≤—É—é —é—Ä–∏–¥–∏—á–µ—Å–∫—É—é —Å–∏–ª—É, –ø–æ –æ–¥–Ω–æ–º—É –¥–ª—è –∫–∞–∂–¥–æ–π –∏–∑ –°—Ç–æ—Ä–æ–Ω.</p>
  <br>
  <p>4. –ù–∞—Å—Ç–æ—è—â–∏–π –∞–∫—Ç —è–≤–ª—è–µ—Ç—Å—è –Ω–µ–æ—Ç—ä–µ–º–ª–µ–º–æ–π —á–∞—Å—Ç—å—é –¥–æ–≥–æ–≤–æ—Ä–∞ –ø–æ –æ–∫–∞–∑–∞–Ω–∏—é —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —É—Å–ª—É–≥ –∏ —É—Å–ª—É–≥ –§—É–ª—Ñ–∏–ª–º–µ–Ω—Ç–∞ ‚Ññ11/3/24 –æ—Ç 11.03.2024 –≥.</p>
  <br><br>
  <table style="border: none; width: 100%;">
    <tr>
      <td style="border: none; width: 50%; vertical-align: top;">
        <p class="bold">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å</p>
        <br>
        <p>–ò–ü –ó–≤–µ—Ä–µ–≤–∞ –Æ–ª–∏–∞–Ω–∞ –í–ª–∞–¥–∏–º–∏—Ä–æ–≤–Ω–∞</p>
        <p>–ò–ù–ù 623406499402</p>
        <p>–û–ì–†–ù–ò–ü 323623400001081</p>
        <p>–ë–∞–Ω–∫: –ú–û–°–ö–û–í–°–ö–ò–ô –§–ò–õ–ò–ê–õ –ê–û –ö–ë "–ú–û–î–£–õ–¨–ë–ê–ù–ö"</p>
        <p>–ë–ò–ö: 044525092</p>
        <p>–∫/—Å ‚Ññ: 30101810645250000092</p>
        <p>–°—á—ë—Ç ‚Ññ: 40802810270013000885</p>
        <p>–ê–¥—Ä–µ—Å: 359210, –†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–∞–ª–º—ã–∫–∏—è,<br>
        –õ–∞–≥–∞–Ω—Å–∫–∏–π —Ä–∞–π–æ–Ω, –ø. –£–ª–∞–Ω –•–æ–ª,<br>
        —É–ª. –ß–∞—Ä–æ–¥–∏–Ω—Å–∫–∞—è –º–∂—Å, –¥. 29, –∫–≤. 7</p>
        <br><br>
        <p>_________________________</p>
      </td>
      <td style="border: none; width: 50%; vertical-align: top;">
        <p class="bold">–ó–∞–∫–∞–∑—á–∏–∫</p>
        <br>
        <p>–ò–ü –ì–∞—Ä—è–µ–≤ –†—É—Å–ª–∞–Ω –ê—Å–ª–∞–Ω–æ–≤–∏—á</p>
        <p>–ò–ù–ù: 910303241077</p>
        <p>–û–ì–†–ù–ò–ü: 320911200033071</p>
        <p>–ë–∞–Ω–∫: –ú–û–°–ö–û–í–°–ö–ò–ô –§–ò–õ–ò–ê–õ –ê–û –ö–ë "–ú–û–î–£–õ–¨–ë–ê–ù–ö"</p>
        <p>–ë–ò–ö: 044525092</p>
        <p>–∫/—Å ‚Ññ: 30101810645250000092</p>
        <p>–°—á—ë—Ç ‚Ññ: 40802810470010467690</p>
        <p>–ê–¥—Ä–µ—Å: 427112, –£–¥–º—É—Ä—Ç—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞,<br>
        —Ä-–Ω. –Ø–∫—à—É—Ä-–ë–æ–¥—å–∏–Ω—Å–∫–∏–π,<br>
        —Å. –°—Ç–∞—Ä—ã–µ –ó—è—Ç—Ü—ã, —É–ª. –°–æ–≤–µ—Ç—Å–∫–∞—è, –¥. 43</p>
        <br><br>
        <p>_________________________</p>
      </td>
    </tr>
  </table>
</body>
</html>`;

        // –§–æ—Ä–º–∏—Ä—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ: "–ê–∫—Ç –ü–ü (–º–µ—Å—è—Ü –≥–æ–¥) –ò–ü –ì–∞—Ä—è–µ–≤"
        const dateObj = new Date(acceptanceDate);
        const year = dateObj.getFullYear();
        const fileName = `–ê–∫—Ç –ü–ü (${selectedMonth} ${year}) –ò–ü –ì–∞—Ä—è–µ–≤`;

        openInGoogleDocs(html, fileName);
      };

      const generateServicesAct = () => {
        if (!workbook || !selectedMonth) {
          alert('–û—à–∏–±–∫–∞: –Ω–µ –≤—ã–±—Ä–∞–Ω Excel —Ñ–∞–π–ª –∏–ª–∏ –º–µ—Å—è—Ü');
          return;
        }

        if (!servicesDate) {
          alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –¥–ª—è –∞–∫—Ç–∞ –æ–∫–∞–∑–∞–Ω–∏—è —É—Å–ª—É–≥');
          return;
        }

        const items = extractItemsData(selectedMonth);

        if (!validateSellerArticles(items)) {
          return;
        }

        const tableRows = items.map((item, index) => `
          <tr>
            <td style="border: 1px solid black; padding: 0px 2px; text-align: center; font-size: 7px;">${index + 1}</td>
            <td style="border: 1px solid black; padding: 0px 2px; font-size: 7px;">${item.name}</td>
            <td style="border: 1px solid black; padding: 0px 2px; text-align: center; font-size: 7px;">${item.quantity}</td>
            <td style="border: 1px solid black; padding: 0px 2px; font-size: 7px;">${item.brand}</td>
            <td style="border: 1px solid black; padding: 0px 2px; font-size: 7px;">${item.sellerArticle || ''}</td>
            <td style="border: 1px solid black; padding: 0px 2px; font-size: 7px;">${item.color}</td>
            <td style="border: 1px solid black; padding: 0px 2px; font-size: 7px;">${item.sku}</td>
            <td style="border: 1px solid black; padding: 0px 2px; text-align: right; font-size: 7px;"></td>
          </tr>
        `).join('');

        const html = `<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>–ê–∫—Ç –æ–∫–∞–∑–∞–Ω–∏—è —É—Å–ª—É–≥</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 40px; line-height: 1.8; }
    table { width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 7px; line-height: 0.9; }
    th, td { border: 1px solid black; padding: 0px 3px; height: 12px; }
    th { background-color: #f0f0f0; font-weight: bold; text-align: center; font-size: 7px; height: 12px; }
    .right-text { text-align: right; }
    .center-text { text-align: center; }
    .bold { font-weight: bold; }
    .date-left { text-align: left; margin-bottom: 20px; }
    p { margin: 10px 0; }
    td:nth-child(1) { width: 3%; }
    td:nth-child(2) { width: 28%; }
    td:nth-child(3) { width: 6%; }
    td:nth-child(4) { width: 12%; }
    td:nth-child(5) { width: 13%; }
    td:nth-child(6) { width: 13%; }
    td:nth-child(7) { width: 13%; }
    td:nth-child(8) { width: 12%; }
  </style>
</head>
<body>
  <p class="date-left"><strong>${servicesDate}</strong></p>
  <p class="right-text">–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Ññ 2</p>
  <br>
  <p class="right-text">–∫ –¥–æ–≥–æ–≤–æ—Ä—É –ø–æ –æ–∫–∞–∑–∞–Ω–∏—é —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —É—Å–ª—É–≥</p>
  <p class="right-text">–∏ —É—Å–ª—É–≥ –§—É–ª—Ñ–∏–ª–º–µ–Ω—Ç–∞ ‚Ññ11/3/24 –æ—Ç 11.03.2024</p>
  <br>
  <h2 class="center-text">–ê–ö–¢ –û–ö–ê–ó–ê–ù–ò–Ø –£–°–õ–£–ì</h2>
  <br>
  <p>–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å –ì–∞—Ä—è–µ–≤ –†—É—Å–ª–∞–Ω –ê—Å–ª–∞–Ω–æ–≤–∏—á, –ò–ù–ù 910303241077 –∏–º–µ–Ω—É–µ–º—ã–π –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –ó–∞–∫–∞–∑—á–∏–∫ —Å –æ–¥–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã –∏ –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å –ó–≤–µ—Ä–µ–≤–∞ –Æ–ª–∏–∞–Ω–∞ –í–ª–∞–¥–∏–º–∏—Ä–æ–≤–Ω–∞, –ò–ù–ù 623406499402, –∏–º–µ–Ω—É–µ–º–∞—è –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å, –∞ —Å–æ–≤–º–µ—Å—Ç–Ω–æ –∏–º–µ–Ω—É–µ–º—ã–µ –°—Ç–æ—Ä–æ–Ω—ã, –∑–∞–∫–ª—é—á–∏–ª–∏ –Ω–∞—Å—Ç–æ—è—â–∏–π –∞–∫—Ç, –æ –Ω–∏–∂–µ—Å–ª–µ–¥—É—é—â–µ–º:</p>
  <br>
  <p>1. –í —Ä–∞–º–∫–∞—Ö –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞ –ø–æ –æ–∫–∞–∑–∞–Ω–∏—é —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —É—Å–ª—É–≥ –∏ —É—Å–ª—É–≥ –§—É–ª—Ñ–∏–ª–º–µ–Ω—Ç–∞ ‚Ññ11/3/24 –æ—Ç 11.03.2024 –≥. –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å, —Å–æ–≥–ª–∞—Å–Ω–æ —Å–±–æ—Ä–æ—á–Ω—ã–º –∑–∞–¥–∞–Ω–∏—è–º, –ø–æ—Å—Ç–∞–≤–∏–ª –Ω–∞ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å Wildberries —Å–ª–µ–¥—É—é—â–∏–µ —Ç–æ–≤–∞—Ä—ã:</p>
  <br>
  <table>
    <tr>
      <th rowspan="2">‚Ññ</th>
      <th colspan="6">–¢–æ–≤–∞—Ä</th>
      <th rowspan="2">–°—Ç–æ–∏–º–æ—Å—Ç—å —É—Å–ª—É–≥</th>
    </tr>
    <tr>
      <th>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</th>
      <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ, —à—Ç.</th>
      <th>–ë—Ä–µ–Ω–¥</th>
      <th>–ê—Ä—Ç–∏–∫—É–ª –ø—Ä–æ–¥–∞–≤—Ü–∞</th>
      <th>–¶–≤–µ—Ç</th>
      <th>SKU</th>
    </tr>
    ${tableRows}
    <tr>
      <td colspan="7" style="text-align: right; font-weight: bold; padding: 0px 2px; font-size: 7px;"><strong>–ò—Ç–æ–≥–æ</strong></td>
      <td style="text-align: right; font-weight: bold; padding: 0px 2px; font-size: 7px;"></td>
    </tr>
  </table>
  <br>
  <p>2. –ù–∞—Å—Ç–æ—è—â–∏–π –∞–∫—Ç —Å–æ—Å—Ç–∞–≤–ª–µ–Ω –≤ –¥–≤—É—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–∞—Ö, –∏–º–µ—é—â–∏—Ö –æ–¥–∏–Ω–∞–∫–æ–≤—É—é —é—Ä–∏–¥–∏—á–µ—Å–∫—É—é —Å–∏–ª—É, –ø–æ –æ–¥–Ω–æ–º—É –¥–ª—è –∫–∞–∂–¥–æ–π –∏–∑ –°—Ç–æ—Ä–æ–Ω.</p>
  <br>
  <p>3. –ù–∞—Å—Ç–æ—è—â–∏–π –∞–∫—Ç —è–≤–ª—è–µ—Ç—Å—è –Ω–µ–æ—Ç—ä–µ–º–ª–µ–º–æ–π —á–∞—Å—Ç—å—é –¥–æ–≥–æ–≤–æ—Ä–∞ –ø–æ –æ–∫–∞–∑–∞–Ω–∏—é —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —É—Å–ª—É–≥ –∏ —É—Å–ª—É–≥ –§—É–ª—Ñ–∏–ª–º–µ–Ω—Ç–∞ ‚Ññ11/3/24 –æ—Ç 11.03.2024 –≥.</p>
  <br><br>
  <table style="border: none; width: 100%;">
    <tr>
      <td style="border: none; width: 50%; vertical-align: top;">
        <p class="bold">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å</p>
        <br>
        <p>–ò–ü –ó–≤–µ—Ä–µ–≤–∞ –Æ–ª–∏–∞–Ω–∞ –í–ª–∞–¥–∏–º–∏—Ä–æ–≤–Ω–∞</p>
        <p>–ò–ù–ù 623406499402</p>
        <p>–û–ì–†–ù–ò–ü 323623400001081</p>
        <p>–ë–∞–Ω–∫: –ú–û–°–ö–û–í–°–ö–ò–ô –§–ò–õ–ò–ê–õ –ê–û –ö–ë "–ú–û–î–£–õ–¨–ë–ê–ù–ö"</p>
        <p>–ë–ò–ö: 044525092</p>
        <p>–∫/—Å ‚Ññ: 30101810645250000092</p>
        <p>–°—á—ë—Ç ‚Ññ: 40802810270013000885</p>
        <p>–ê–¥—Ä–µ—Å: 359210, –†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–∞–ª–º—ã–∫–∏—è,<br>
        –õ–∞–≥–∞–Ω—Å–∫–∏–π —Ä–∞–π–æ–Ω, –ø. –£–ª–∞–Ω –•–æ–ª,<br>
        —É–ª. –ß–∞—Ä–æ–¥–∏–Ω—Å–∫–∞—è –º–∂—Å, –¥. 29, –∫–≤. 7</p>
        <br><br>
        <p>_________________________</p>
      </td>
      <td style="border: none; width: 50%; vertical-align: top;">
        <p class="bold">–ó–∞–∫–∞–∑—á–∏–∫</p>
        <br>
        <p>–ò–ü –ì–∞—Ä—è–µ–≤ –†—É—Å–ª–∞–Ω –ê—Å–ª–∞–Ω–æ–≤–∏—á</p>
        <p>–ò–ù–ù: 910303241077</p>
        <p>–û–ì–†–ù–ò–ü: 320911200033071</p>
        <p>–ë–∞–Ω–∫: –ú–û–°–ö–û–í–°–ö–ò–ô –§–ò–õ–ò–ê–õ –ê–û –ö–ë "–ú–û–î–£–õ–¨–ë–ê–ù–ö"</p>
        <p>–ë–ò–ö: 044525092</p>
        <p>–∫/—Å ‚Ññ: 30101810645250000092</p>
        <p>–°—á—ë—Ç ‚Ññ: 40802810470010467690</p>
        <p>–ê–¥—Ä–µ—Å: 427112, –£–¥–º—É—Ä—Ç—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞,<br>
        —Ä-–Ω. –Ø–∫—à—É—Ä-–ë–æ–¥—å–∏–Ω—Å–∫–∏–π,<br>
        —Å. –°—Ç–∞—Ä—ã–µ –ó—è—Ç—Ü—ã, —É–ª. –°–æ–≤–µ—Ç—Å–∫–∞—è, –¥. 43</p>
        <br><br>
        <p>_________________________</p>
      </td>
    </tr>
  </table>
</body>
</html>`;

        // –§–æ—Ä–º–∏—Ä—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ: "–ê–∫—Ç –û–£ (–º–µ—Å—è—Ü –≥–æ–¥) –ò–ü –ì–∞—Ä—è–µ–≤"
        const dateObj = new Date(servicesDate);
        const year = dateObj.getFullYear();
        const fileName = `–ê–∫—Ç –û–£ (${selectedMonth} ${year}) –ò–ü –ì–∞—Ä—è–µ–≤`;

        openInGoogleDocs(html, fileName);
      };

      const openInGoogleDocs = (html, title) => {
        try {
          // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º HTML –≤ DOCX
          const converted = htmlDocx.asBlob(html);

          // –°–∫–∞—á–∏–≤–∞–µ–º DOCX —Ñ–∞–π–ª
          const link = document.createElement('a');
          link.href = URL.createObjectURL(converted);
          link.download = `${title}.docx`;
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          URL.revokeObjectURL(link.href);
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞:', error);
        }
      };

      return (
        <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-8">
          <div className="max-w-4xl mx-auto">
            <div className="bg-white rounded-2xl shadow-xl p-8">
              <div className="flex items-center justify-between mb-4">
                <h1 className="text-3xl font-bold text-gray-800">
                  –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∞–∫—Ç–æ–≤ Wildberries
                </h1>
                <span className="bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full text-sm font-semibold">
                  v2.4.1
                </span>
              </div>
              <p className="text-gray-600 mb-8">
                –ó–∞–≥—Ä—É–∑–∏—Ç–µ Excel —Ñ–∞–π–ª –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∞–∫—Ç–æ–≤ —á–µ—Ä–µ–∑ Google Docs
              </p>

              <div className="mb-8">
                <h3 className="font-semibold text-gray-800 mb-3">üìã –§–∞–π–ª —Å –±—Ä–µ–Ω–¥–∞–º–∏ (—Ç–∞–±–ª–∏—Ü–∞ –∞—Ä—Ç–∏–∫—É–ª–æ–≤)</h3>
                <label className="block mb-4">
                  <div className="border-2 border-dashed border-green-300 rounded-lg p-6 text-center hover:border-green-500 transition-colors cursor-pointer bg-green-50">
                    <input
                      type="file"
                      accept=".xlsx,.xls"
                      onChange={handleBrandsFileUpload}
                      className="hidden"
                    />
                    <p className="text-gray-700 font-medium">
                      {brandsFile ? `‚úÖ ${brandsFile.name} (${Object.keys(brandsMap).length} –±—Ä–µ–Ω–¥–æ–≤)` : '–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞ –±—Ä–µ–Ω–¥–æ–≤'}
                    </p>
                    <p className="text-gray-500 text-sm mt-2">–§–∞–π–ª —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏ "–ë—Ä–µ–Ω–¥" –∏ "–ê—Ä—Ç–∏–∫—É–ª WB"</p>
                  </div>
                </label>
              </div>

              <div className="mb-8">
                <h3 className="font-semibold text-gray-800 mb-3">üìä Excel —Ñ–∞–π–ª —Å –ø–æ—Å—Ç–∞–≤–∫–∞–º–∏</h3>
                <label className="block mb-4">
                  <div className="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-indigo-500 transition-colors cursor-pointer">
                    <input
                      type="file"
                      accept=".xlsx,.xls"
                      onChange={handleFileUpload}
                      className="hidden"
                    />
                    <svg className="mx-auto h-12 w-12 text-gray-400 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                    </svg>
                    <p className="text-gray-700 font-medium">
                      {file ? file.name : '–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞'}
                    </p>
                    <p className="text-gray-500 text-sm mt-2">XLSX –∏–ª–∏ XLS</p>
                  </div>
                </label>
              </div>

              {loading && (
                <div className="text-center py-8">
                  <div className="inline-block animate-spin-slow">
                    <svg width="80" height="80" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                      <circle cx="100" cy="100" r="90" fill="#00A7E1" />
                      <text x="100" y="120" fontSize="60" fontWeight="bold" fontFamily="Arial, sans-serif" fill="white" textAnchor="middle">M</text>
                      <circle cx="100" cy="100" r="85" fill="none" stroke="white" strokeWidth="3" />
                    </svg>
                  </div>
                  <p className="mt-4 text-gray-600 font-semibold">–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞...</p>
                </div>
              )}

              {months.length > 0 && !loading && (
                <>
                  <div className="mb-8">
                    <label className="block text-gray-700 font-medium mb-3">
                      –í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Å—è—Ü:
                    </label>
                    <select
                      value={selectedMonth}
                      onChange={(e) => setSelectedMonth(e.target.value)}
                      className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                    >
                      <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Å—è—Ü --</option>
                      {months.map((month) => (
                        <option key={month} value={month}>
                          {month}
                        </option>
                      ))}
                    </select>
                  </div>

                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <div>
                      <label className="block text-gray-700 font-medium mb-3">
                        –î–∞—Ç–∞ –∞–∫—Ç–∞ –ø—Ä–∏–µ–º–∞-–ø–µ—Ä–µ–¥–∞—á–∏:
                      </label>
                      <input
                        type="date"
                        value={acceptanceDate}
                        onChange={(e) => setAcceptanceDate(e.target.value)}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                      />
                    </div>
                    <div>
                      <label className="block text-gray-700 font-medium mb-3">
                        –î–∞—Ç–∞ –∞–∫—Ç–∞ –æ–∫–∞–∑–∞–Ω–∏—è —É—Å–ª—É–≥:
                      </label>
                      <input
                        type="date"
                        value={servicesDate}
                        onChange={(e) => setServicesDate(e.target.value)}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                      />
                    </div>
                  </div>
                </>
              )}

              {selectedMonth && (
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <button
                    onClick={generateAcceptanceAct}
                    className="bg-indigo-600 text-white px-6 py-4 rounded-lg hover:bg-indigo-700 transition-colors font-medium shadow-lg hover:shadow-xl"
                  >
                    üìÑ –°–æ–∑–¥–∞—Ç—å –∞–∫—Ç –ø—Ä–∏–µ–º–∞-–ø–µ—Ä–µ–¥–∞—á–∏
                  </button>
                  <button
                    onClick={generateServicesAct}
                    className="bg-green-600 text-white px-6 py-4 rounded-lg hover:bg-green-700 transition-colors font-medium shadow-lg hover:shadow-xl"
                  >
                    üìã –°–æ–∑–¥–∞—Ç—å –∞–∫—Ç –æ–∫–∞–∑–∞–Ω–∏—è —É—Å–ª—É–≥
                  </button>
                </div>
              )}

              <div className="mt-8 p-4 bg-blue-50 rounded-lg">
                <h3 className="font-medium text-blue-900 mb-2">‚ÑπÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:</h3>
                <ul className="text-sm text-blue-800 space-y-1">
                  <li>1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ Excel —Ñ–∞–π–ª –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –º–µ—Å—è—Ü</li>
                  <li>2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∞–∫—Ç–∞</li>
                  <li>3. –û—Ç–∫—Ä–æ–µ—Ç—Å—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å –ø—Ä–æ—Å—Ç—ã–º–∏ —à–∞–≥–∞–º–∏</li>
                  <li>4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤ Google Docs</li>
                  <li>5. –°–∫–∞—á–∞–π—Ç–µ –≥–æ—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –∫–∞–∫ DOCX</li>
                  <li>‚Ä¢ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–æ–≤–∞—Ä—ã —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "–ü—Ä–æ–¥–∞–Ω–æ"</li>
                  <li>‚Ä¢ –¢–∞–±–ª–∏—Ü—ã –≤ –æ–±–æ–∏—Ö –∞–∫—Ç–∞—Ö —Å–æ–≤–ø–∞–¥–∞—é—Ç –ø–æ SKU, –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∏ —Ü–≤–µ—Ç—É</li>
                </ul>
              </div>

              <div className="mt-8 pt-6 border-t border-gray-200">
                <details className="group">
                  <summary className="cursor-pointer font-medium text-gray-700 hover:text-indigo-600 transition-colors flex items-center gap-2">
                    <span className="text-lg">üìù</span>
                    <span>–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π (Changelog)</span>
                    <span className="ml-auto text-gray-400 group-open:rotate-180 transition-transform">‚ñº</span>
                  </summary>
                  <div className="mt-4 space-y-6 text-sm text-gray-700">
                    <div className="border-l-4 border-violet-500 pl-4">
                      <h4 className="font-bold text-violet-700 mb-1">v2.4.1 - 19.01.2026 01:40 –ú–°–ö</h4>
                      <p className="font-semibold text-gray-600 mb-2">–ò–∑–º–µ–Ω–µ–Ω–æ:</p>
                      <ul className="list-disc list-inside space-y-1">
                        <li>–í—ã—Å–æ—Ç–∞ —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü —É–º–µ–Ω—å—à–µ–Ω–∞ –≤ 2 —Ä–∞–∑–∞ (height: 12px)</li>
                        <li>–£–º–µ–Ω—å—à–µ–Ω—ã –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã (padding: 0px 2px)</li>
                        <li>–î–æ–±–∞–≤–ª–µ–Ω line-height: 0.9 –¥–ª—è —Ç–∞–±–ª–∏—Ü</li>
                      </ul>
                    </div>

                    <div className="border-l-4 border-blue-600 pl-4">
                      <h4 className="font-bold text-blue-700 mb-1">v2.4.0 - 19.01.2026 01:35 –ú–°–ö</h4>
                      <p className="font-semibold text-gray-600 mb-2">–î–æ–±–∞–≤–ª–µ–Ω–æ:</p>
                      <ul className="list-disc list-inside space-y-1">
                        <li>–ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ª–æ–≥–æ—Ç–∏–ø Makita –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞ —Å –ø–æ—Å—Ç–∞–≤–∫–∞–º–∏</li>
                        <li>–ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –≤—Ä–∞—â–µ–Ω–∏—è (2 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ –æ–±–æ—Ä–æ—Ç)</li>
                      </ul>
                    </div>

                    <div className="border-l-4 border-sky-500 pl-4">
                      <h4 className="font-bold text-sky-700 mb-1">v2.3.2 - 19.01.2026 01:30 –ú–°–ö</h4>
                      <p className="font-semibold text-gray-600 mb-2">–ò–∑–º–µ–Ω–µ–Ω–æ:</p>
                      <ul className="list-disc list-inside space-y-1">
                        <li>–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —à–∏—Ä–∏–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ —Ç–∞–±–ª–∏—Ü –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏</li>
                        <li>–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ —Ç–∞–±–ª–∏—Ü —É–º–µ–Ω—å—à–µ–Ω –¥–æ 7px –≤ —Å—Ç–∏–ª—è—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞</li>
                        <li>–î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —à–∏—Ä–∏–Ω—ã —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö</li>
                      </ul>
                    </div>

                    <div className="border-l-4 border-cyan-500 pl-4">
                      <h4 className="font-bold text-cyan-700 mb-1">v2.3.1 - 19.01.2026 01:25 –ú–°–ö</h4>
                      <p className="font-semibold text-gray-600 mb-2">–î–æ–±–∞–≤–ª–µ–Ω–æ:</p>
                      <ul className="list-disc list-inside space-y-1">
                        <li>–î–∞—Ç–∞ –≤ –∞–∫—Ç –æ–∫–∞–∑–∞–Ω–∏—è —É—Å–ª—É–≥</li>
                      </ul>
                      <p className="font-semibold text-gray-600 mb-2 mt-2">–ò–∑–º–µ–Ω–µ–Ω–æ:</p>
                      <ul className="list-disc list-inside space-y-1">
                        <li>–ï—â–µ –±–æ–ª—å—à–µ —É–º–µ–Ω—å—à–µ–Ω—ã —Ç–∞–±–ª–∏—Ü—ã (—à—Ä–∏—Ñ—Ç 7px, –æ—Ç—Å—Ç—É–ø—ã 1px 3px)</li>
                      </ul>
                      <p className="font-semibold text-gray-600 mb-2 mt-2">–£–¥–∞–ª–µ–Ω–æ:</p>
                      <ul className="list-disc list-inside space-y-1">
                        <li>–£–±—Ä–∞–Ω alert –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ —Å –∞—Ä—Ç–∏–∫—É–ª–∞–º–∏</li>
                      </ul>
                    </div>

                    <div className="border-l-4 border-teal-500 pl-4">
                      <h4 className="font-bold text-teal-700 mb-1">v2.3.0 - 19.01.2026 01:15 –ú–°–ö</h4>
                      <p className="font-semibold text-gray-600 mb-2">–î–æ–±–∞–≤–ª–µ–Ω–æ:</p>
                      <ul className="list-disc list-inside space-y-1">
                        <li>–ù–æ–≤—ã–µ —à–∞–±–ª–æ–Ω—ã –Ω–∞–∑–≤–∞–Ω–∏–π —Ñ–∞–π–ª–æ–≤: "–ê–∫—Ç –û–£ (–º–µ—Å—è—Ü –≥–æ–¥) –ò–ü –ì–∞—Ä—è–µ–≤" –∏ "–ê–∫—Ç –ü–ü (–º–µ—Å—è—Ü –≥–æ–¥) –ò–ü –ì–∞—Ä—è–µ–≤"</li>
                      </ul>
                      <p className="font-semibold text-gray-600 mb-2 mt-2">–ò–∑–º–µ–Ω–µ–Ω–æ:</p>
                      <ul className="list-disc list-inside space-y-1">
                        <li>–£–º–µ–Ω—å—à–µ–Ω—ã —Ç–∞–±–ª–∏—Ü—ã –≤ –∞–∫—Ç–∞—Ö (—à—Ä–∏—Ñ—Ç 8px, –æ—Ç—Å—Ç—É–ø—ã 2px 4px)</li>
                      </ul>
                      <p className="font-semibold text-gray-600 mb-2 mt-2">–£–¥–∞–ª–µ–Ω–æ:</p>
                      <ul className="list-disc list-inside space-y-1">
                        <li>–£–±—Ä–∞–Ω—ã –≤—Å–ø–ª—ã–≤–∞—é—â–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤</li>
                      </ul>
                    </div>

                    <div className="border-l-4 border-orange-500 pl-4">
                      <h4 className="font-bold text-orange-700 mb-1">v2.2.1 - 19.01.2026 01:00 –ú–°–ö</h4>
                      <p className="font-semibold text-gray-600 mb-2">–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:</p>
                      <ul className="list-disc list-inside space-y-1">
                        <li>–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –º–æ—Å–∫–æ–≤—Å–∫–æ–µ –≤—Ä–µ–º—è –≤–æ –≤—Å–µ—Ö –≤–µ—Ä—Å–∏—è—Ö changelog</li>
                      </ul>
                    </div>

                    <div className="border-l-4 border-red-500 pl-4">
                      <h4 className="font-bold text-red-700 mb-1">v2.2.0 - 19.01.2026 00:59 –ú–°–ö</h4>
                      <p className="font-semibold text-gray-600 mb-2">–î–æ–±–∞–≤–ª–µ–Ω–æ:</p>
                      <ul className="list-disc list-inside space-y-1">
                        <li>–ü—Ä—è–º–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è DOCX —Ñ–∞–π–ª–æ–≤ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ Google Docs</li>
                        <li>–î–∞—Ç–∞ –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ —Ñ–∞–π–ª–∞ —Ç–µ–ø–µ—Ä—å –±–µ—Ä–µ—Ç—Å—è –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –¥–∞—Ç—ã –∞–∫—Ç–∞</li>
                        <li>–í—Ä–µ–º—è –ø–æ –ú–æ—Å–∫–≤–µ –≤ –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π</li>
                      </ul>
                      <p className="font-semibold text-gray-600 mb-2 mt-2">–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:</p>
                      <ul className="list-disc list-inside space-y-1">
                        <li>–£–±—Ä–∞–Ω—ã –¥–∞—Ç–∞, –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ –ø—É—Ç—å –ø—Ä–∏ –ø–µ—á–∞—Ç–∏ (Ctrl+P)</li>
                      </ul>
                    </div>

                    <div className="border-l-4 border-indigo-500 pl-4">
                      <h4 className="font-bold text-indigo-700 mb-1">v2.1.1 - 18.01.2026 23:45 –ú–°–ö</h4>
                      <p className="font-semibold text-gray-600 mb-2">–î–æ–±–∞–≤–ª–µ–Ω–æ:</p>
                      <ul className="list-disc list-inside space-y-1">
                        <li>–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ</li>
                        <li>–°–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π (changelog) –≤ —Ñ—É—Ç–µ—Ä–µ —Å–∞–π—Ç–∞</li>
                      </ul>
                    </div>

                    <div className="border-l-4 border-green-500 pl-4">
                      <h4 className="font-bold text-green-700 mb-1">v2.1.0 - 18.01.2026 23:30 –ú–°–ö</h4>
                      <p className="font-semibold text-gray-600 mb-2">–î–æ–±–∞–≤–ª–µ–Ω–æ:</p>
                      <ul className="list-disc list-inside space-y-1">
                        <li>–°—Ç–æ–ª–±–µ—Ü "–ê—Ä—Ç–∏–∫—É–ª –ø—Ä–æ–¥–∞–≤—Ü–∞" –≤ –∞–∫—Ç –ø—Ä–∏—ë–º–∞-–ø–µ—Ä–µ–¥–∞—á–∏</li>
                        <li>–°—Ç–æ–ª–±–µ—Ü "–ê—Ä—Ç–∏–∫—É–ª –ø—Ä–æ–¥–∞–≤—Ü–∞" –≤ –∞–∫—Ç –æ–∫–∞–∑–∞–Ω–∏—è —É—Å–ª—É–≥</li>
                        <li>–í–∞–ª–∏–¥–∞—Ü–∏—è –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –ø—Ä–æ–¥–∞–≤—Ü–∞ –º–µ–∂–¥—É –¥–≤—É–º—è –∞–∫—Ç–∞–º–∏</li>
                        <li>–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π –≤ –¥–∞–Ω–Ω—ã—Ö</li>
                        <li>–°–∫—Ä–∏–ø—Ç deploy –≤ package.json –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–µ–ø–ª–æ—è</li>
                        <li>CHANGELOG.md –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤–µ—Ä—Å–∏–π</li>
                      </ul>
                      <p className="font-semibold text-gray-600 mb-2 mt-2">–ò–∑–º–µ–Ω–µ–Ω–æ:</p>
                      <ul className="list-disc list-inside space-y-1">
                        <li>–û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü –≤ –æ–±–æ–∏—Ö –∞–∫—Ç–∞—Ö</li>
                      </ul>
                    </div>

                    <div className="border-l-4 border-blue-500 pl-4">
                      <h4 className="font-bold text-blue-700 mb-1">v2.0.0 - 18.01.2026 20:00 –ú–°–ö</h4>
                      <p className="font-semibold text-gray-600 mb-2">–î–æ–±–∞–≤–ª–µ–Ω–æ:</p>
                      <ul className="list-disc list-inside space-y-1">
                        <li>–ó–∞–≥—Ä—É–∑–∫–∞ –≤–Ω–µ—à–Ω–µ–≥–æ —Ñ–∞–π–ª–∞ —Å –±—Ä–µ–Ω–¥–∞–º–∏</li>
                        <li>–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–ª–æ–Ω–∫–∏ "–ê—Ä—Ç–∏–∫—É–ª –ø—Ä–æ–¥–∞–≤—Ü–∞" –≤ —Ñ–∞–π–ª–µ –±—Ä–µ–Ω–¥–æ–≤</li>
                        <li>–£–º–Ω–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –≤ Excel —Ñ–∞–π–ª–∞—Ö</li>
                        <li>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–∞ –±—Ä–µ–Ω–¥–æ–≤ –Ω–∞–¥ Excel —Ñ–∞–π–ª–æ–º</li>
                      </ul>
                    </div>

                    <div className="border-l-4 border-purple-500 pl-4">
                      <h4 className="font-bold text-purple-700 mb-1">v1.0.0 - 18.01.2026 17:00 –ú–°–ö</h4>
                      <p className="font-semibold text-gray-600 mb-2">–î–æ–±–∞–≤–ª–µ–Ω–æ:</p>
                      <ul className="list-disc list-inside space-y-1">
                        <li>–ü–µ—Ä–≤—ã–π —Ä–µ–ª–∏–∑ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π React –≤–µ—Ä—Å–∏–∏</li>
                        <li>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞–∫—Ç–∞ –ø—Ä–∏—ë–º–∞-–ø–µ—Ä–µ–¥–∞—á–∏</li>
                        <li>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞–∫—Ç–∞ –æ–∫–∞–∑–∞–Ω–∏—è —É—Å–ª—É–≥</li>
                        <li>–ü–æ–¥–¥–µ—Ä–∂–∫–∞ 119 —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –∞—Ä—Ç–∏–∫—É–ª–æ–≤ —Å –±—Ä–µ–Ω–¥–∞–º–∏</li>
                        <li>–≠–∫—Å–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ Google Docs</li>
                        <li>–†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ Vercel</li>
                      </ul>
                    </div>
                  </div>
                </details>
              </div>
            </div>
          </div>
        </div>
      );
    };

    ReactDOM.render(<ActsGenerator />, document.getElementById('root'));
  </script>
</body>
</html>
